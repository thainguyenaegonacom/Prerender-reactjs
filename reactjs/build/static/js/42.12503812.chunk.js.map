{"version":3,"sources":["images/icons/successful-payment.svg","images/icons/cancel-payment.svg","containers/PaymentVerifyPage/index.tsx"],"names":["PaymentSuccessPage","useState","statusChecked","setStatusChecked","verify","setVerify","dispatch","useDispatch","useParams","status","id","useEffect","options","url","PUT_PLACE_ORDER_CHECKOUT","method","body","fetchClient","then","res","success","optionsOrder","GET_ORDER_HISTORY","data","order_uuid","purchaseCheckout","user","guest","localStorage","removeItem","setLineItems","isError","catch","className","src","successfulPayment","alt","to","cancelPayment"],"mappings":"uGAAe,QAA0B,gD,iCCA1B,QAA0B,4C,0KC8G1BA,UAnGf,WACE,MAA0CC,mBAAc,MAAxD,mBAAOC,EAAP,KAAsBC,EAAtB,KACA,EAA4BF,oBAAc,GAA1C,mBAAOG,EAAP,KAAeC,EAAf,KACMC,EAAWC,cACjB,EAAuBC,cAAfC,EAAR,EAAQA,OAAQC,EAAhB,EAAgBA,GA+ChB,OA9CAC,qBAAU,WACR,IAAMC,EAAU,CACdC,IAAI,GAAD,OAAKC,KAAL,OAAgCJ,EAAhC,oBACHK,OAAQ,OACRC,KAAM,MAGM,WAAVP,EACFQ,YAAYL,GACTM,MAAK,SAACC,GACL,GAAIA,EAAIC,QAAS,CAAC,IAAD,MACTC,EAAe,CACnBR,IAAI,GAAD,OAAKS,KAAL,cAAyBH,QAAzB,IAAyBA,GAAzB,UAAyBA,EAAKI,YAA9B,aAAyB,EAAWC,YACvCT,OAAQ,MACRC,KAAM,MAIRb,GAAiB,GACjBE,GAAU,GAGVY,YAAYI,GAAcH,MAAK,SAACC,GAC9B,IAAQI,EAASJ,EAATI,KAERE,YAAiBF,OAGnB,OAAIJ,QAAJ,IAAIA,GAAJ,UAAIA,EAAKI,YAAT,iBAAI,EAAWG,YAAf,aAAI,EAAiBC,QACnBC,aAAaC,WAAW,gBAG1BD,aAAaC,WAAW,eAExBvB,EAASwB,YAAa,UACbX,EAAIY,UACb5B,GAAiB,GACjBE,GAAU,OAGb2B,OAAM,kBAAM3B,GAAU,OAEzBF,GAAiB,GACjBE,GAAU,MAEX,IAED,0BAAS4B,UAAU,6BAAnB,UACI/B,EAUY,WAAVO,GAAuBL,EACzB,sBAAK6B,UAAU,kBAAf,UACE,qBAAKC,IAAKC,IAAmBC,IAAI,KACjC,4CACA,6DACA,cAAC,IAAD,CAAMC,GAAG,IAAT,kCAEU,UAAV5B,EACF,sBAAKwB,UAAU,kBAAf,UACE,qBAAKC,IAAKI,IAAeF,IAAI,KAC7B,4DACA,cAAC,IAAD,CAAMC,GAAG,YAAT,iCAEU,UAAV5B,EACF,sBAAKwB,UAAU,kBAAf,UACE,qBAAKC,IAAKI,IAAeF,IAAI,KAC7B,sCACA,2EACA,cAAC,IAAD,CAAMC,GAAG,YAAT,iCAGF,GA9BA,0BAASJ,UAAU,SAAnB,UACE,8DACA,sBAAKA,UAAU,eAAf,UACE,wBACA,wBACA,wBACA,8BA0BL/B,IAAkBE,EACjB,sBAAK6B,UAAU,kBAAf,UACE,qBAAKC,IAAKI,IAAeF,IAAI,KAC7B,qDACA,gFACA,cAAC,IAAD,CAAMC,GAAG,YAAT,iCAGF","file":"static/js/42.12503812.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/successful-payment.08385652.svg\";","export default __webpack_public_path__ + \"static/media/cancel-payment.f939aa43.svg\";","import React, { useEffect, useState } from 'react';\r\nimport './styles.scss';\r\nimport { Link, useParams } from 'react-router-dom';\r\nimport successfulPayment from '../../images/icons/successful-payment.svg';\r\nimport cancelPayment from '../../images/icons/cancel-payment.svg';\r\nimport { useDispatch } from 'react-redux';\r\nimport { setLineItems } from '../../redux/product/actions';\r\nimport { fetchClient } from '../../redux/Helpers';\r\nimport { GET_ORDER_HISTORY, PUT_PLACE_ORDER_CHECKOUT } from '../../config';\r\nimport { purchaseCheckout } from '../../utils/helpers/productTracker';\r\n\r\nfunction PaymentSuccessPage(): JSX.Element {\r\n  const [statusChecked, setStatusChecked] = useState<any>(null);\r\n  const [verify, setVerify] = useState<any>(false);\r\n  const dispatch = useDispatch();\r\n  const { status, id } = useParams<any>();\r\n  useEffect(() => {\r\n    const options = {\r\n      url: `${PUT_PLACE_ORDER_CHECKOUT}${id}/success/verify/`,\r\n      method: 'POST',\r\n      body: null,\r\n    };\r\n\r\n    if (status == 'success') {\r\n      fetchClient(options)\r\n        .then((res) => {\r\n          if (res.success) {\r\n            const optionsOrder = {\r\n              url: `${GET_ORDER_HISTORY}${res?.data?.order_uuid}`,\r\n              method: 'GET',\r\n              body: null,\r\n            };\r\n\r\n            // Set status\r\n            setStatusChecked(true);\r\n            setVerify(true);\r\n\r\n            // Ecommerce google analytic\r\n            fetchClient(optionsOrder).then((res) => {\r\n              const { data } = res;\r\n              // console.log(res);\r\n              purchaseCheckout(data);\r\n            });\r\n\r\n            if (res?.data?.user?.guest) {\r\n              localStorage.removeItem('sundoraToken');\r\n            }\r\n\r\n            localStorage.removeItem('id_checkout');\r\n\r\n            dispatch(setLineItems([]));\r\n          } else if (res.isError) {\r\n            setStatusChecked(true);\r\n            setVerify(false);\r\n          }\r\n        })\r\n        .catch(() => setVerify(false));\r\n    } else {\r\n      setStatusChecked(true);\r\n      setVerify(true);\r\n    }\r\n  }, []);\r\n  return (\r\n    <section className=\"section-PaymentSuccessPage\">\r\n      {!statusChecked ? (\r\n        <section className=\"verify\">\r\n          <h4>Searching for verify payment</h4>\r\n          <div className=\"lds-ellipsis\">\r\n            <div></div>\r\n            <div></div>\r\n            <div></div>\r\n            <div></div>\r\n          </div>\r\n        </section>\r\n      ) : status == 'success' && verify ? (\r\n        <div className=\"status-box done\">\r\n          <img src={successfulPayment} alt=\"\" />\r\n          <h3>THANK YOU!</h3>\r\n          <h4>Your payment was successful</h4>\r\n          <Link to=\"/\">Continue shopping</Link>\r\n        </div>\r\n      ) : status == 'cancel' ? (\r\n        <div className=\"status-box done\">\r\n          <img src={cancelPayment} alt=\"\" />\r\n          <h4>Your payment was cancelled</h4>\r\n          <Link to=\"/checkout\">Back to checkout</Link>\r\n        </div>\r\n      ) : status == 'failed' ? (\r\n        <div className=\"status-box done\">\r\n          <img src={cancelPayment} alt=\"\" />\r\n          <h3>OOP!</h3>\r\n          <h4>Your payment was failed. Please try again</h4>\r\n          <Link to=\"/checkout\">Back to checkout</Link>\r\n        </div>\r\n      ) : (\r\n        ''\r\n      )}\r\n      {statusChecked && !verify ? (\r\n        <div className=\"status-box done\">\r\n          <img src={cancelPayment} alt=\"\" />\r\n          <h4>VERIFICATION FAILED</h4>\r\n          <h4>Your id payment is incorrect. Please try again</h4>\r\n          <Link to=\"/checkout\">Back to checkout</Link>\r\n        </div>\r\n      ) : (\r\n        ''\r\n      )}\r\n    </section>\r\n  );\r\n}\r\nexport default PaymentSuccessPage;\r\n"],"sourceRoot":""}