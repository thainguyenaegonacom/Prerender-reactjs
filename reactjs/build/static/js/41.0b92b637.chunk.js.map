{"version":3,"sources":["images/icons/successful-payment.svg","images/icons/cancel-payment.svg","containers/OrderCODVerifyPage/index.tsx"],"names":["OrderCODVerifyPage","useState","statusChecked","setStatusChecked","verify","setVerify","guest","setGuest","textSuccess","setTextSuccess","dispatch","useDispatch","useParams","status","id","useEffect","options","url","PUT_PLACE_ORDER_CHECKOUT","method","body","guestUser","localStorage","getItem","fetchClient","then","res","success","optionsOrder","GET_ORDER_HISTORY","data","order","uuid","shipping","purchaseCheckout","user","removeItem","clearCart","isError","catch","className","src","successfulPayment","alt","to","cancelPayment"],"mappings":"uGAAe,QAA0B,gD,iCCA1B,QAA0B,4C,0KC0H1BA,UA/Gf,WACE,MAA0CC,mBAAc,MAAxD,mBAAOC,EAAP,KAAsBC,EAAtB,KACA,EAA4BF,oBAAc,GAA1C,mBAAOG,EAAP,KAAeC,EAAf,KACA,EAA0BJ,oBAAkB,GAA5C,mBAAOK,EAAP,KAAcC,EAAd,KACA,EAAsCN,mBAAc,0BAApD,mBAAOO,EAAP,KAAoBC,EAApB,KACMC,EAAWC,cACjB,EAAuBC,cAAfC,EAAR,EAAQA,OAAQC,EAAhB,EAAgBA,GAqDhB,OApDAC,qBAAU,WACR,IAAMC,EAAU,CACdC,IAAI,GAAD,OAAKC,KAAL,OAAgCJ,EAAhC,kBACHK,OAAQ,OACRC,KAAM,MAER,GAAc,WAAVP,EAAqB,CACvB,IAAMQ,IAAcC,aAAaC,QAAQ,oBACrCF,GAAWd,GAAS,GACxBiB,YAAYR,GACTS,MAAK,SAACC,GACL,GAAIA,EAAIC,QAAS,CAAC,IAAD,YACTC,EAAe,CACnBX,IAAI,GAAD,OAAKY,KAAL,cAAyBH,QAAzB,IAAyBA,GAAzB,UAAyBA,EAAKI,YAA9B,iBAAyB,EAAWC,aAApC,aAAyB,EAAkBC,KAA3C,KACHb,OAAQ,MACRC,KAAM,OAIJ,OAACM,QAAD,IAACA,GAAD,UAACA,EAAKI,YAAN,iBAAC,EAAWC,aAAZ,aAAC,EAAkBE,WACrBxB,EAAe,kBAIjBN,GAAiB,GACjBE,GAAU,GAGVmB,YAAYI,GAAcH,MAAK,SAACC,GAC9B,IAAQI,EAASJ,EAATI,KACRI,YAAiBJ,OAGnB,OAAIJ,QAAJ,IAAIA,GAAJ,UAAIA,EAAKI,YAAT,iBAAI,EAAWK,YAAf,aAAI,EAAiB7B,QACnBgB,aAAac,WAAW,gBAG1Bd,aAAac,WAAW,eACpBf,GAAWC,aAAac,WAAW,oBAEvC1B,EAAS2B,oBACAX,EAAIY,UACbnC,GAAiB,GACjBE,GAAU,OAGbkC,OAAM,kBAAMlC,GAAU,WAEzBF,GAAiB,GACjBE,GAAU,KAEX,IAED,0BAASmC,UAAU,6BAAnB,UACItC,EAUY,WAAVW,GAAuBT,EACzB,sBAAKoC,UAAU,kBAAf,UACE,qBAAKC,IAAKC,IAAmBC,IAAI,KACjC,4CACA,6BAAKnC,IACJF,EACC,cAAC,IAAD,CAAMsC,GAAG,IAAT,0BAEA,cAAC,IAAD,CAAMA,GAAG,yBAAT,4BAGQ,UAAV/B,EACF,sBAAK2B,UAAU,kBAAf,UACE,qBAAKC,IAAKI,IAAeF,IAAI,KAC7B,sDACA,cAAC,IAAD,CAAMC,GAAG,YAAT,iCAEU,UAAV/B,EACF,sBAAK2B,UAAU,kBAAf,UACE,qBAAKC,IAAKI,IAAeF,IAAI,KAC7B,sCACA,yEACA,cAAC,IAAD,CAAMC,GAAG,YAAT,iCAGF,GAlCA,0BAASJ,UAAU,SAAnB,UACE,4DACA,sBAAKA,UAAU,eAAf,UACE,wBACA,wBACA,wBACA,8BA8BLtC,IAAkBE,EACjB,sBAAKoC,UAAU,kBAAf,UACE,qBAAKC,IAAKI,IAAeF,IAAI,KAC7B,qDACA,2EACA,cAAC,IAAD,CAAMC,GAAG,YAAT,iCAGF","file":"static/js/41.0b92b637.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/successful-payment.08385652.svg\";","export default __webpack_public_path__ + \"static/media/cancel-payment.f939aa43.svg\";","import React, { useEffect, useState } from 'react';\r\nimport './styles.scss';\r\nimport { Link, useParams } from 'react-router-dom';\r\nimport successfulPayment from '../../images/icons/successful-payment.svg';\r\nimport cancelPayment from '../../images/icons/cancel-payment.svg';\r\nimport { useDispatch } from 'react-redux';\r\nimport { clearCart } from '../../redux/product/actions';\r\nimport { fetchClient } from '../../redux/Helpers';\r\nimport { GET_ORDER_HISTORY, PUT_PLACE_ORDER_CHECKOUT } from '../../config';\r\nimport { purchaseCheckout } from '../../utils/helpers/productTracker';\r\n\r\nfunction OrderCODVerifyPage(): JSX.Element {\r\n  const [statusChecked, setStatusChecked] = useState<any>(null);\r\n  const [verify, setVerify] = useState<any>(false);\r\n  const [guest, setGuest] = useState<boolean>(false);\r\n  const [textSuccess, setTextSuccess] = useState<any>('Orders pay on delivery');\r\n  const dispatch = useDispatch();\r\n  const { status, id } = useParams<any>();\r\n  useEffect(() => {\r\n    const options = {\r\n      url: `${PUT_PLACE_ORDER_CHECKOUT}${id}/order_verify/`,\r\n      method: 'POST',\r\n      body: null,\r\n    };\r\n    if (status == 'success') {\r\n      const guestUser = !!localStorage.getItem('sundora_guest_id');\r\n      if (guestUser) setGuest(true);\r\n      fetchClient(options)\r\n        .then((res) => {\r\n          if (res.success) {\r\n            const optionsOrder = {\r\n              url: `${GET_ORDER_HISTORY}${res?.data?.order?.uuid}/`,\r\n              method: 'GET',\r\n              body: null,\r\n            };\r\n\r\n            // Set text\r\n            if (!res?.data?.order?.shipping) {\r\n              setTextSuccess('Cash on pickup');\r\n            }\r\n\r\n            // Set status\r\n            setStatusChecked(true);\r\n            setVerify(true);\r\n\r\n            // Ecommerce google analytic\r\n            fetchClient(optionsOrder).then((res) => {\r\n              const { data } = res;\r\n              purchaseCheckout(data);\r\n            });\r\n\r\n            if (res?.data?.user?.guest) {\r\n              localStorage.removeItem('sundoraToken');\r\n            }\r\n\r\n            localStorage.removeItem('id_checkout');\r\n            if (guestUser) localStorage.removeItem('sundora_guest_id');\r\n\r\n            dispatch(clearCart());\r\n          } else if (res.isError) {\r\n            setStatusChecked(true);\r\n            setVerify(false);\r\n          }\r\n        })\r\n        .catch(() => setVerify(false));\r\n    } else {\r\n      setStatusChecked(true);\r\n      setVerify(true);\r\n    }\r\n  }, []);\r\n  return (\r\n    <section className=\"section-PaymentSuccessPage\">\r\n      {!statusChecked ? (\r\n        <section className=\"verify\">\r\n          <h4>Searching for verify order</h4>\r\n          <div className=\"lds-ellipsis\">\r\n            <div></div>\r\n            <div></div>\r\n            <div></div>\r\n            <div></div>\r\n          </div>\r\n        </section>\r\n      ) : status == 'success' && verify ? (\r\n        <div className=\"status-box done\">\r\n          <img src={successfulPayment} alt=\"\" />\r\n          <h3>THANK YOU!</h3>\r\n          <h4>{textSuccess}</h4>\r\n          {guest ? (\r\n            <Link to=\"/\">Back to home</Link>\r\n          ) : (\r\n            <Link to=\"/account/order-history\">View orders</Link>\r\n          )}\r\n        </div>\r\n      ) : status == 'cancel' ? (\r\n        <div className=\"status-box done\">\r\n          <img src={cancelPayment} alt=\"\" />\r\n          <h4>Your order cancelled</h4>\r\n          <Link to=\"/checkout\">Back to checkout</Link>\r\n        </div>\r\n      ) : status == 'failed' ? (\r\n        <div className=\"status-box done\">\r\n          <img src={cancelPayment} alt=\"\" />\r\n          <h3>OOP!</h3>\r\n          <h4>Your order was failed. Please try again</h4>\r\n          <Link to=\"/checkout\">Back to checkout</Link>\r\n        </div>\r\n      ) : (\r\n        ''\r\n      )}\r\n      {statusChecked && !verify ? (\r\n        <div className=\"status-box done\">\r\n          <img src={cancelPayment} alt=\"\" />\r\n          <h4>VERIFICATION FAILED</h4>\r\n          <h4>Your order is incorrect. Please try again</h4>\r\n          <Link to=\"/checkout\">Back to checkout</Link>\r\n        </div>\r\n      ) : (\r\n        ''\r\n      )}\r\n    </section>\r\n  );\r\n}\r\nexport default OrderCODVerifyPage;\r\n"],"sourceRoot":""}