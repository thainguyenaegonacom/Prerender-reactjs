{"version":3,"sources":["images/icons/addToCart-white.svg","images/block-questionnaire/logo.png","components/BlockQuestionnaire/BlockProduct/itemProduct.tsx","components/BlockQuestionnaire/BlockProduct/index.tsx","images/block-questionnaire/left-arrow.svg","images/block-questionnaire/home.svg","components/BlockQuestionnaire/index.tsx"],"names":["itemProduct","productItem","state","useSelector","productReducer","itemProductRef","useRef","useState","image","setImage","dispatch","useDispatch","keyEndpoint","value","history","useHistory","useEffect","current","width","clientHeight","height","images","url","className","fixed_rebate","style","visibility","ref","Picture","data","brand","name","sale","moneyFormater","product_variants","price","onClick","handle","brandName","brand_page","page_ptr","push","e","stopPropagation","variant","variant_id","quantity","index","lineItems","findIndex","copyArr","newData","addProductToCart","title","action","actionHome","src","icAddToCart","alt","BlockProduct","productList","subTitle","selectedIndex","setSelectedIndex","handleSlider","type","length","isMobile","selected","fillParent","mobileTouch","buttons","bullets","onTransitionEnd","currentIndex","map","item","marginBottom","memo","BlockQuestionnaire","dataQuestionnaire","setDataQuestionnaire","question","setQuestion","questionSliderIndex","setQuestionSliderIndex","questionIndex","answerKey","answerTemp","setAnswerTemp","loadingProduct","setLoadingProduct","dotClick","setDotClick","products","setProducts","productNotExists","setProductNotExists","lastQuestion","setLastQuestion","fetchDataInit","a","isEmpty","options","GET_QUESTIONNAIRE","method","body","fetchClient","res","handleBackOrReStartQuestion","questionClone","pop","handleGetProduct","childQuestion","children","find","parent_answer","params","questionnaire_id","id","collections","collection","scents","scent","questionParent","answer","questionTemp","slice","handleQuestion","backgroundImage","background","webp","backgroundSize","DotLoader","icBack","to","icHome","SundoraLogo","padding","handleAnswerTemp","Array","from","keys","handleQuestionSliderDot"],"mappings":"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","file":"static/js/13.2e36aefb.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/addToCart-white.47327068.svg\";","export default __webpack_public_path__ + \"static/media/logo.d1cd0572.png\";","import React, { useEffect, useRef, useState } from 'react';\r\nimport icAddToCart from '../../../images/icons/addToCart-white.svg';\r\nimport Picture from '../../Picture';\r\nimport { useDispatch, useSelector, RootStateOrAny } from 'react-redux';\r\nimport * as action from '../../../redux/product/actions';\r\nimport * as actionHome from '../../../redux/home/actions';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { moneyFormater } from '../../../redux/Helpers';\r\nimport { addProductToCart } from '../../../utils/helpers/productTracker';\r\n\r\nfunction itemProduct({ productItem }: { productItem: any }) {\r\n  const state = useSelector((state: RootStateOrAny) => state.productReducer);\r\n  const itemProductRef = useRef<any>(null);\r\n  const [image, setImage] = useState({});\r\n  const dispatch = useDispatch();\r\n  const keyEndpoint = productItem?.value ? productItem?.value : productItem;\r\n  const handleCheckoutProduct = (e: any) => {\r\n    e.stopPropagation();\r\n    const variant = keyEndpoint?.product_variants[0] || {};\r\n    const data = {\r\n      // variant_id: 39482168017060,\r\n      variant_id: variant?.variant_id ?? '',\r\n      quantity: 1,\r\n    };\r\n    const index = state?.lineItems.findIndex(function (e: any) {\r\n      return e.variant_id == data.variant_id;\r\n    });\r\n    const copyArr = [...state?.lineItems];\r\n\r\n    if (index != -1) {\r\n      const newData = {\r\n        variant_id: data.variant_id,\r\n        quantity: state?.lineItems[index].quantity + data.quantity,\r\n      };\r\n      copyArr[index] = newData;\r\n    } else {\r\n      copyArr.push(data);\r\n    }\r\n\r\n    addProductToCart({\r\n      ...keyEndpoint,\r\n      variant_id: variant.variant_id,\r\n      price: variant?.price,\r\n      title: variant?.title,\r\n      quantity: 1,\r\n    });\r\n\r\n    dispatch(action.checkoutProduct(copyArr));\r\n\r\n    dispatch(actionHome.toggleShoppingbag(true));\r\n  };\r\n  const history = useHistory();\r\n\r\n  const directDetailProduct = (handle: any, brandName: any) => {\r\n    history.push('/brand/' + brandName + '/' + handle);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (itemProductRef && itemProductRef.current) {\r\n      const width = itemProductRef.current.clientHeight;\r\n      const height = itemProductRef.current.clientHeight;\r\n      setImage({\r\n        ...keyEndpoint.images[0]?.url,\r\n        width: width,\r\n        height: height,\r\n      });\r\n    }\r\n  }, [keyEndpoint, itemProductRef]);\r\n  return (\r\n    <div\r\n      className=\"product-item-box\"\r\n      // onClick={() => {\r\n      //   directDetailProduct(keyEndpoint.handle, keyEndpoint?.brand_page?.page_ptr?.handle);\r\n      // }}\r\n    >\r\n      <div className=\"favorite-box\">\r\n        {/* <img\r\n          src={icHeart}\r\n          alt=\"\"\r\n          style={{ visibility: !productItem.is_favorite ? 'visible' : 'hidden' }}\r\n        /> */}\r\n        <div></div>\r\n\r\n        {keyEndpoint.fixed_rebate ? (\r\n          <span\r\n            className=\"sale-inf\"\r\n            style={{ visibility: keyEndpoint.fixed_rebate > 0 ? 'visible' : 'hidden' }}\r\n          >\r\n            {keyEndpoint.fixed_rebate > 0 ? `-${keyEndpoint.fixed_rebate}%` : ''}\r\n          </span>\r\n        ) : (\r\n          ''\r\n        )}\r\n        {/* <span\r\n          className=\"sale-inf bonus\"\r\n          style={{ display: productItem.bonus ? 'flex' : 'none' }}\r\n        >\r\n          3{' '}\r\n          <span>\r\n            <span>FOR</span> 2\r\n          </span>\r\n        </span> */}\r\n      </div>\r\n      <div className=\"img-product\" ref={itemProductRef}>\r\n        <Picture data={image} />\r\n      </div>\r\n      <div className=\"bot\">\r\n        <div className=\"row\">\r\n          <div className=\"info\">\r\n            <p className=\"title-item\">{keyEndpoint.brand?.name}</p>\r\n            <p className=\"title-info\">{keyEndpoint?.name}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"row\">\r\n          <div className=\" info\">\r\n            <span className={`money ${productItem.sale ? 'sale-price' : ''}`}>\r\n              {moneyFormater(keyEndpoint?.product_variants[0].price)}\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <button\r\n          className=\"btn-detail\"\r\n          onClick={() => {\r\n            directDetailProduct(keyEndpoint.handle, keyEndpoint?.brand_page?.page_ptr?.handle);\r\n          }}\r\n        >\r\n          Discover\r\n        </button>\r\n        <button className=\"btn-add\" onClick={handleCheckoutProduct}>\r\n          ADD TO BAG\r\n          <img src={icAddToCart} alt=\"ic-add-to-cart\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// itemProduct.propTypes = {\r\n//   productItem: PropTypes.object.isRequired,\r\n// };\r\n\r\nexport default itemProduct;\r\n","import React, { memo, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ItemProduct from './itemProduct';\r\nimport { map } from 'lodash';\r\nimport { isMobile } from '../../../DetectScreen';\r\nimport AwesomeSlider from 'react-awesome-slider';\r\n\r\nfunction BlockProduct({\r\n  productList,\r\n  title,\r\n  subTitle,\r\n}: {\r\n  productList: any;\r\n  title: string;\r\n  subTitle: string;\r\n}) {\r\n  const [selectedIndex, setSelectedIndex] = useState<number>(0);\r\n\r\n  const handleSlider = (type: string) => {\r\n    if (type == 'next') {\r\n      setSelectedIndex(\r\n        selectedIndex + 1 >= productList.length ? productList.length - 1 : selectedIndex + 1,\r\n      );\r\n      return;\r\n    }\r\n    if (type == 'prev') {\r\n      setSelectedIndex(selectedIndex - 1 <= 0 ? 0 : selectedIndex - 1);\r\n      return;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <section className=\"blk-questionnaire-product\">\r\n      <div className=\"container\">\r\n        {/* Title */}\r\n        {title ? <h3 className=\"title-block\">{title}</h3> : ''}\r\n\r\n        {/* Sub title */}\r\n        {subTitle ? <p className=\"sub-title-block\">{subTitle}</p> : ''}\r\n\r\n        {/* line center */}\r\n        <div className=\"line-center\"></div>\r\n\r\n        <div className={`${!isMobile ? 'row' : ''} list-product`}>\r\n          {isMobile ? (\r\n            <>\r\n              <AwesomeSlider\r\n                selected={selectedIndex}\r\n                fillParent={false}\r\n                mobileTouch={true}\r\n                buttons={false}\r\n                bullets={true}\r\n                className=\"animation-slider\"\r\n                onTransitionEnd={(e: any) => {\r\n                  setSelectedIndex(e.currentIndex);\r\n                }}\r\n              >\r\n                {map(productList, (item: any, index: number) => (\r\n                  <div\r\n                    className=\"animated fasted fade-in\"\r\n                    key={index}\r\n                    style={{ marginBottom: 16 }}\r\n                  >\r\n                    <ItemProduct productItem={item} />\r\n                  </div>\r\n                ))}\r\n              </AwesomeSlider>\r\n              <div className=\"group-button\">\r\n                <button\r\n                  className={`next ${\r\n                    selectedIndex == productList.length - 1 ? 'btn-end' : ''\r\n                  }`}\r\n                  onClick={() => {\r\n                    handleSlider('next');\r\n                  }}\r\n                >\r\n                  <span className=\"material-icons\">navigate_next</span>\r\n                </button>\r\n                <button\r\n                  className={`prev ${selectedIndex == 0 ? 'btn-end' : ''}`}\r\n                  onClick={() => {\r\n                    handleSlider('prev');\r\n                  }}\r\n                >\r\n                  <span className=\"material-icons\">navigate_next</span>\r\n                </button>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <>\r\n              {map(productList, (item: any, index: number) => (\r\n                <div\r\n                  className=\"col-lg-3 col-md-4 col-6 animated fasted fade-in\"\r\n                  key={index}\r\n                  style={{ marginBottom: 16 }}\r\n                >\r\n                  <ItemProduct productItem={item} />\r\n                </div>\r\n              ))}\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\nBlockProduct.propTypes = {\r\n  productList: PropTypes.array,\r\n  title: PropTypes.string,\r\n};\r\n\r\nexport default memo(BlockProduct);\r\n","export default __webpack_public_path__ + \"static/media/left-arrow.3c5c1c94.svg\";","export default __webpack_public_path__ + \"static/media/home.9bf8126f.svg\";","import { isEmpty } from 'lodash';\r\nimport React, { memo, useEffect, useState } from 'react';\r\nimport SundoraLogo from '../../images/block-questionnaire/logo.png';\r\nimport { GET_QUESTIONNAIRE } from '../../config';\r\nimport { fetchClient } from '../../redux/Helpers';\r\nimport AwesomeSlider from 'react-awesome-slider';\r\nimport 'react-awesome-slider/src/core/styles.scss';\r\nimport DotLoader from '../DotLoader';\r\nimport BlockProduct from './BlockProduct';\r\nimport { isMobile } from '../../DetectScreen';\r\nimport icBack from '../../images/block-questionnaire/left-arrow.svg';\r\nimport icHome from '../../images/block-questionnaire/home.svg';\r\nimport { Link } from 'react-router-dom';\r\n\r\nfunction BlockQuestionnaire({ data }: { data: any }) {\r\n  const [dataQuestionnaire, setDataQuestionnaire] = useState<any>([]);\r\n  const [question, setQuestion] = useState<any>([]);\r\n  const [questionSliderIndex, setQuestionSliderIndex] = useState<any>(0);\r\n  const [answerTemp, setAnswerTemp] = useState<any>({\r\n    questionIndex: null,\r\n    answerKey: null,\r\n  });\r\n  // const [questionReady, setQuestionReady] = useState<boolean>(false);\r\n  const [loadingProduct, setLoadingProduct] = useState<boolean>(false);\r\n  const [dotClick, setDotClick] = useState<boolean>(false);\r\n  const [products, setProducts] = useState<Array<any>>([]);\r\n  const [productNotExists, setProductNotExists] = useState<boolean>(false);\r\n  const [lastQuestion, setLastQuestion] = useState<boolean>(false);\r\n\r\n  const fetchDataInit = async () => {\r\n    if (isEmpty(dataQuestionnaire)) {\r\n      const options = {\r\n        url: `${GET_QUESTIONNAIRE}${data?.value}`,\r\n        method: 'GET',\r\n        body: null,\r\n      };\r\n      try {\r\n        const res = await fetchClient(options);\r\n        if (res.length > 0) {\r\n          setDataQuestionnaire(res);\r\n          setQuestion([...question, { ...res[0] }]);\r\n        }\r\n      } catch (error) {\r\n        // toastrError(error.message);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleAnswerTemp = (index: any, answerKey: any) => {\r\n    if (index == 5) {\r\n      setLastQuestion(true);\r\n    } else {\r\n      setLastQuestion(false);\r\n    }\r\n    setAnswerTemp({\r\n      ...answerTemp,\r\n      questionIndex: index,\r\n      answerKey: answerKey,\r\n    });\r\n  };\r\n\r\n  const handleQuestionSliderDot = (index: any) => {\r\n    if (index < question.length && index != questionSliderIndex) {\r\n      if (questionSliderIndex > 0) {\r\n        const questionClone = [...question];\r\n        setQuestion(questionClone.slice(0, index + 1));\r\n      }\r\n      setQuestionSliderIndex(index);\r\n      setDotClick(true);\r\n    }\r\n  };\r\n\r\n  const handleBackOrReStartQuestion = () => {\r\n    if (productNotExists || products.length > 0) {\r\n      setProducts([]);\r\n      setQuestion([{ ...dataQuestionnaire[0] }]);\r\n      setQuestionSliderIndex(0);\r\n      setProductNotExists(false);\r\n      return;\r\n    }\r\n    if (questionSliderIndex > 0) {\r\n      const questionClone = [...question];\r\n      questionClone.pop();\r\n      setQuestion(questionClone);\r\n    }\r\n    const index = questionSliderIndex == 0 ? 0 : questionSliderIndex - 1;\r\n    setQuestionSliderIndex(index);\r\n    setDotClick(true);\r\n  };\r\n\r\n  const handleQuestion = () => {\r\n    if (answerTemp.questionIndex == null) {\r\n      return;\r\n    }\r\n    const questionParent = question.find(\r\n      (item: any, index: any) => index == answerTemp.questionIndex,\r\n    );\r\n    if (!lastQuestion && questionParent && questionParent.children) {\r\n      const answer = questionParent.children.find(\r\n        (item: any) => item.data.parent_answer == `answer_${answerTemp.answerKey}`,\r\n      );\r\n      if (answer) {\r\n        if (dotClick) {\r\n          const questionTemp = question.slice(0, answerTemp.questionIndex + 1);\r\n          setQuestion([...questionTemp, { ...answer }]);\r\n          setQuestionSliderIndex(questionTemp.length);\r\n          setDotClick(false);\r\n        } else {\r\n          setQuestion([...question, { ...answer }]);\r\n          setQuestionSliderIndex(question.length);\r\n        }\r\n        setAnswerTemp({\r\n          ...answerTemp,\r\n          questionIndex: null,\r\n          answerKey: null,\r\n        });\r\n        // setQuestionReady(true);\r\n      } else {\r\n        setLoadingProduct(true);\r\n      }\r\n      return;\r\n    }\r\n    setLoadingProduct(true);\r\n  };\r\n\r\n  const handleGetProduct = async () => {\r\n    const lastQuestion = question[question.length - 1];\r\n    let childQuestion = lastQuestion;\r\n    if (lastQuestion?.children && lastQuestion?.children.length > 0) {\r\n      childQuestion = lastQuestion.children.find(\r\n        (item: any) => item.data.parent_answer == `answer_${answerTemp.answerKey}`,\r\n      );\r\n    }\r\n    const params = {\r\n      questionnaire_id: childQuestion?.id,\r\n      collections: childQuestion?.data?.collection,\r\n      scents: childQuestion?.data?.scent,\r\n    };\r\n    const options = {\r\n      url: `${GET_QUESTIONNAIRE}`,\r\n      method: 'POST',\r\n      body: params,\r\n    };\r\n    try {\r\n      const res = await fetchClient(options);\r\n      setProducts(res.products);\r\n      setLoadingProduct(false);\r\n      if (res.products.length == 0) {\r\n        setProductNotExists(true);\r\n      }\r\n    } catch (error) {\r\n      // console.log(error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDataInit();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (loadingProduct) {\r\n      handleGetProduct();\r\n    }\r\n  }, [loadingProduct]);\r\n\r\n  useEffect(() => {\r\n    handleQuestion();\r\n  }, [answerTemp]);\r\n\r\n  return (\r\n    <div\r\n      className=\"site-questionnaire\"\r\n      style={{ backgroundImage: `url('${data?.background?.webp}')`, backgroundSize: 'cover' }}\r\n    >\r\n      {loadingProduct ? <DotLoader /> : ''}\r\n      <div className={`container ${products.length > 0 ? 'opacity-none' : ''}`}>\r\n        {/* Posision asoluste */}\r\n        <button className={`btn-back`} onClick={handleBackOrReStartQuestion}>\r\n          {/* <span className=\"material-icons\">trending_flat</span> */}\r\n          <img className=\"ic-back\" src={icBack} alt=\"ic-back\" />\r\n          <span>{productNotExists || products.length > 0 ? 'RESTART QUIZ' : 'BACK'}</span>\r\n        </button>\r\n\r\n        <Link className={`btn-home`} to=\"/\">\r\n          {/* <span className=\"material-icons\">home</span> */}\r\n          <img className=\"ic-home\" src={icHome} alt=\"ic-home\" />\r\n          <br />\r\n          <span>HOME</span>\r\n        </Link>\r\n\r\n        {/* Logo */}\r\n        <div className=\"logo\">\r\n          <img src={SundoraLogo} width={130} height=\"auto\" alt=\"sundora-logo\" />\r\n        </div>\r\n\r\n        {productNotExists ? (\r\n          <div className=\"product-not-exists\">\r\n            <h2>\r\n              There is no suitable product for you,{' '}\r\n              <span onClick={handleBackOrReStartQuestion}>please try again</span>.\r\n            </h2>\r\n          </div>\r\n        ) : products.length > 0 ? (\r\n          <BlockProduct\r\n            productList={products}\r\n            title={'Top products for you:'}\r\n            subTitle={'Based on your answers here it what we recommend'}\r\n          />\r\n        ) : (\r\n          <div className=\"question\">\r\n            {/* Text question */}\r\n            <h2 className=\"text-question-step\">Question {questionSliderIndex + 1} / 6</h2>\r\n\r\n            <AwesomeSlider\r\n              selected={questionSliderIndex}\r\n              fillParent={false}\r\n              mobileTouch={false}\r\n              bullets={false}\r\n              className=\"animation-slider\"\r\n              buttons={false}\r\n            >\r\n              {question.map((item: any, index: any) => (\r\n                <div key={index} className=\"detail-question\">\r\n                  {/* Text question name */}\r\n                  <h1 className=\"text-question-name\">{item.data.question}</h1>\r\n\r\n                  {/* line center */}\r\n                  <div className=\"line-center\"></div>\r\n\r\n                  {/* Block answer */}\r\n                  <div className=\"row\" style={{ padding: isMobile ? 20 : 13 }}>\r\n                    {[1, 2, 3, 4].map((answer: any) => (\r\n                      <button\r\n                        key={answer}\r\n                        onClick={() => {\r\n                          handleAnswerTemp(index, answer);\r\n                        }}\r\n                        className={`${isMobile ? 'col-12' : 'col'} block-answer ${\r\n                          answerTemp.answerKey == answer ? 'block-answer-active' : ''\r\n                        } ${item.data[`answer_${answer}`] != '' ? '' : 'd-none'}`}\r\n                      >\r\n                        <p>{item.data[`answer_${answer}`]}</p>\r\n                      </button>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </AwesomeSlider>\r\n\r\n            {/* btn next {question */}\r\n            {/* <button className=\"btn-next\" onClick={handleQuestion}>\r\n              <span>Next question</span>\r\n              <span className=\"material-icons\">\r\n                navigate_next\r\n              </span>\r\n            </button> */}\r\n\r\n            {/* group dot */}\r\n            <div className=\"group-dot\">\r\n              {Array.from(Array(6).keys()).map((item: any, index: any) => (\r\n                <button\r\n                  key={index}\r\n                  className={`btn-dot${index < question.length ? ' btn-dot-active' : ''}`}\r\n                  onClick={() => handleQuestionSliderDot(index)}\r\n                ></button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default memo(BlockQuestionnaire);\r\n"],"sourceRoot":""}